% Original data OTU ordering
OTU_IDS = [1124701 697997  203969  205391  843189  3431064 156611 ...
           2867534 4440638 216549  4440611 4416927 2578357 1122202 ...
           3616127 2285453 252012  224043  113212  804187  1876538 ...
           148890  3749019 4424782 364805  255018  222209  4367783 ...
           825937  208293  1121144 357011  214611  607006  154567 ...
           592291  1638797 156065  4362556 279138  1806981 850823 ...
           4322321 1139779 112795  14632   1127423 792450  3330572 ...
           1024089 4440396 146676  834883  4450823 1062704 223583  ...
           732929  319907  1094976 1147699 242467  845780  1123837 ...
           238800  1130478 588042  831289  3639039 4468200 1122517 ...
           4447334 663880  2601820 75371   1146003 209803  742260  ...
           766178  4466061 216805  211129  213177  215692  4346060 ...
           1123984 1129210 4423681 211848  136959  356045  148783 ...
           4351648 4461578 78839   154494  1142972 746927  146397  ...
           523224  1104509 572134  256536  154519  4470139 4681 ...
           512006  160908  1137157 4341561 143135  4409771 171768 ... 
           83531   151283  1108390 4478794];


% Check OTU IDs correspondence 
       
load('data/logX_pHdata.mat');
load('data/taxTablepHData.mat');
load('data/pHData.mat')
[n,p] = size(X);

% Assign OTU IDs to X data from the split data

%% Check first that X and logX_pHData are identical; checked!!
% matchIDs = zeros(p,1);
% 
% for i=1:p
%     currX = X(:,i);
%     matchIDs(i) = find(abs(sum(logX_pHdata-currX))<1e-3)
% end
    
%% Find ordering of the labels
permIDs = zeros(p,1);

for i=1:p
    currID = OTU_IDS(i);
    permIDs(i) = find((taxTablepHData.OTU_ID-currID)==0);
end

correctTaxTable = taxTablepHData(permIDs,:);
    
    
    
